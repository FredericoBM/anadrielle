<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Host | Gerenciar Conteúdo</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;700;800&display=swap" rel="stylesheet">
    <style>
        :root { --rosa: #ffbcca; --verde: #a8bfa1; --slate: #334155; --bg: #fdfafb; --white: #ffffff; --glass: rgba(255, 255, 255, 0.85); }
        
        /* --- BLOQUEIO DE SELEÇÃO --- */
        * { 
            margin: 0; padding: 0; box-sizing: border-box; 
            cursor: none; 
            /* Impede a seleção de texto em toda a página */
            user-select: none; 
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        /* Permite seleção APENAS nos campos de digitação para você conseguir editar */
        input, textarea {
            user-select: text !important;
            -webkit-user-select: text !important;
            -moz-user-select: text !important;
            -ms-user-select: text !important;
        }

        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: var(--bg); color: var(--slate); padding: 40px 20px; display: flex; justify-content: center; min-height: 100vh; overflow-x: hidden; }

        /* Cursor Customizado */
        #custom-cursor { position: fixed; width: 20px; height: 20px; background: var(--rosa); border-radius: 50%; pointer-events: none; z-index: 9999; mix-blend-mode: multiply; transition: transform 0.1s ease; }

        /* Samambaias Decorativas */
        .fern { position: fixed; width: 250px; height: auto; z-index: 0; opacity: 0.4; pointer-events: none; }
        .fern.top-right { top: -20px; right: -20px; transform: scaleX(-1); }
        .fern.bottom-left { bottom: -20px; left: -20px; transform: scaleY(-1); }
        .fern-frond { fill: none; stroke: var(--verde); stroke-width: 2.5; stroke-linecap: round; animation: sway 10s infinite alternate; transform-origin: top; }
        @keyframes sway { from { transform: rotate(-3deg); } to { transform: rotate(3deg); } }

        /* Cartão Principal */
        .admin-card { background: var(--glass); backdrop-filter: blur(25px); width: 100%; max-width: 700px; padding: 40px; border-radius: 40px; box-shadow: 0 25px 50px rgba(0,0,0,0.05); border: 1px solid rgba(255,255,255,0.7); position: relative; z-index: 2; }
        
        h1 { margin-bottom: 30px; font-weight: 800; border-left: 6px solid var(--rosa); padding-left: 20px; letter-spacing: -1px; }
        
        form { display: flex; flex-direction: column; gap: 15px; margin-bottom: 40px; padding: 25px; border-radius: 25px; background: rgba(255,255,255,0.5); border: 1px solid transparent; transition: 0.3s; }
        form.edit-mode { border-color: var(--verde); background: rgba(168, 191, 161, 0.1); }

        label { font-size: 0.7rem; font-weight: 800; text-transform: uppercase; color: var(--verde); letter-spacing: 1px; }
        input, textarea { padding: 15px; border: 1px solid rgba(0,0,0,0.05); border-radius: 15px; outline: none; font-family: inherit; font-size: 0.9rem; transition: 0.3s; }
        input:focus, textarea:focus { border-color: var(--rosa); background: white; cursor: text; }

        .btn-main { padding: 18px; background: var(--slate); color: white; border: none; border-radius: 15px; font-weight: 800; cursor: none; transition: 0.3s; }
        .btn-main:hover { background: var(--rosa); color: var(--slate); transform: translateY(-3px); }
        .btn-cancel { background: #eee; color: #666; margin-top: -10px; padding: 10px; border-radius: 10px; border: none; font-size: 0.7rem; font-weight: 800; cursor: none; display: none; }

        /* Lista de Caixas */
        .list-header { font-weight: 800; font-size: 0.9rem; margin-bottom: 15px; display: block; color: var(--slate); opacity: 0.6; }
        .list-item { background: white; padding: 15px 20px; border-radius: 22px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.02); transition: 0.3s; border: 1px solid transparent; }
        .list-item:hover { transform: scale(1.02); border-color: var(--rosa); }
        
        .item-info { display: flex; align-items: center; gap: 15px; }
        .item-info img { width: 50px; height: 50px; border-radius: 12px; object-fit: cover; background: #eee; }
        .item-info div strong { display: block; font-size: 0.9rem; }
        .item-info div span { font-size: 0.7rem; color: var(--verde); font-weight: 800; text-transform: uppercase; }

        .actions { display: flex; gap: 8px; }
        .btn-action { padding: 8px 15px; border-radius: 10px; border: none; font-size: 0.7rem; font-weight: 800; cursor: none; transition: 0.2s; }
        .btn-edit { background: #e8f5e9; color: #2e7d32; }
        .btn-edit:hover { background: #2e7d32; color: white; }
        .btn-delete { background: #fff0f0; color: #d32f2f; }
        .btn-delete:hover { background: #d32f2f; color: white; }

        @media (max-width: 600px) { .list-item { flex-direction: column; gap: 15px; text-align: center; } .item-info { flex-direction: column; } }
    </style>
</head>
<body oncontextmenu="return false" oncopy="return false">
    <div id="custom-cursor"></div>
    
    <svg class="fern top-right" viewBox="0 0 400 500"><path class="fern-frond" d="M20,0 C60,80 10,200 120,350 M120,350 l-20,-30 M100,300 l-25,-20" /></svg>
    <svg class="fern bottom-left" viewBox="0 0 400 500"><path class="fern-frond" d="M20,0 C60,80 10,200 120,350 M100,300 l-25,-20" /></svg>

    <div class="admin-card">
        <a href="index.html" style="text-decoration: none; color: var(--slate); font-weight: 800; font-size: 0.75rem; margin-bottom: 25px; display: inline-block; opacity: 0.5;">← Voltar ao Início</a>
        
        <h1 id="form-title">Adicionar Nova Caixa</h1>
        
        <form id="box-form">
            <label>Categoria</label>
            <input type="text" id="badge" placeholder="Ex: Engenharia, Odonto..." required>
            
            <label>Título</label>
            <input type="text" id="titulo" placeholder="O título da seção" required>
            
            <label>Descrição</label>
            <textarea id="texto" rows="3" placeholder="Escreva o conteúdo aqui..." required></textarea>
            
            <label id="label-foto">Foto (Selecione do PC)</label>
            <input type="file" id="fotoLocal" accept="image/*">
            <small id="edit-msg" style="display:none; font-size: 0.65rem; color: var(--verde);">* Deixe vazio para manter a foto atual.</small>
            
            <button type="submit" id="btn-submit" class="btn-main">Publicar no Site ✦</button>
            <button type="button" id="btn-cancel" class="btn-cancel" onclick="resetForm()">Cancelar Edição</button>
        </form>

        <span class="list-header">Caixas Ativas no Home</span>
        <div id="lista-caixas"></div>
    </div>

    <script>
        const cursor = document.getElementById('custom-cursor');
        const form = document.getElementById('box-form');
        const lista = document.getElementById('lista-caixas');
        const btnSubmit = document.getElementById('btn-submit');
        const btnCancel = document.getElementById('btn-cancel');
        const formTitle = document.getElementById('form-title');
        const editMsg = document.getElementById('edit-msg');

        // Bloqueio extra via Script para comandos de teclado (Ctrl+C, Ctrl+U, etc)
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && (e.key === 'c' || e.key === 'u' || e.key === 's' || e.key === 'p')) {
                e.preventDefault();
                return false;
            }
        });

        let baseDeDados = JSON.parse(localStorage.getItem('site_caixas_local')) || [];
        let editIndex = null;

        document.addEventListener('mousemove', (e) => {
            cursor.style.left = e.clientX + 'px';
            cursor.style.top = e.clientY + 'px';
        });

        function salvar() {
            localStorage.setItem('site_caixas_local', JSON.stringify(baseDeDados));
            renderizarLista();
        }

        function renderizarLista() {
            lista.innerHTML = baseDeDados.length === 0 ? '<p style="font-size:0.8rem; opacity:0.5;">Nenhuma caixa criada.</p>' : "";
            baseDeDados.forEach((item, index) => {
                lista.innerHTML += `
                    <div class="list-item">
                        <div class="item-info">
                            <img src="${item.fotoData}" alt="preview">
                            <div>
                                <strong>${item.titulo}</strong>
                                <span>${item.badge}</span>
                            </div>
                        </div>
                        <div class="actions">
                            <button class="btn-action btn-edit" onclick="prepararEdicao(${index})">Editar</button>
                            <button class="btn-action btn-delete" onclick="remover(${index})">Excluir</button>
                        </div>
                    </div>
                `;
            });
        }

        form.addEventListener('submit', function(e) {
            e.preventDefault();
            const file = document.getElementById('fotoLocal').files[0];
            const reader = new FileReader();

            const processarDados = (imgData) => {
                const dados = {
                    badge: document.getElementById('badge').value,
                    titulo: document.getElementById('titulo').value,
                    texto: document.getElementById('texto').value,
                    fotoData: imgData || (editIndex !== null ? baseDeDados[editIndex].fotoData : "")
                };

                if (editIndex !== null) {
                    baseDeDados[editIndex] = dados;
                    alert("Caixa atualizada com sucesso!");
                } else {
                    if(!imgData) return alert("Por favor, selecione uma foto.");
                    baseDeDados.push(dados);
                    alert("Nova caixa publicada!");
                }

                resetForm();
                salvar();
            };

            if (file) {
                reader.onloadend = () => processarDados(reader.result);
                reader.readAsDataURL(file);
            } else {
                processarDados(null);
            }
        });

        window.prepararEdicao = (index) => {
            editIndex = index;
            const item = baseDeDados[index];
            document.getElementById('badge').value = item.badge;
            document.getElementById('titulo').value = item.titulo;
            document.getElementById('texto').value = item.texto;
            form.classList.add('edit-mode');
            formTitle.innerText = "Editando Caixa";
            btnSubmit.innerText = "Salvar Alterações ✦";
            btnCancel.style.display = "block";
            editMsg.style.display = "block";
            document.getElementById('fotoLocal').required = false;
            window.scrollTo({ top: 0, behavior: 'smooth' });
        };

        window.resetForm = () => {
            editIndex = null;
            form.reset();
            form.classList.remove('edit-mode');
            formTitle.innerText = "Adicionar Nova Caixa";
            btnSubmit.innerText = "Publicar no Site ✦";
            btnCancel.style.display = "none";
            editMsg.style.display = "none";
            document.getElementById('fotoLocal').required = true;
        };

        window.remover = (index) => {
            if (confirm("Tem certeza que deseja excluir esta caixa permanentemente?")) {
                baseDeDados.splice(index, 1);
                salvar();
            }
        };

        renderizarLista();
    </script>
</body>
</html>
